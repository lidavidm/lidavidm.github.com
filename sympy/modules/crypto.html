<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Basic Cryptography Module &mdash; SymPy 1.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://95.sympy-live-tests.appspot.com/static/live-core.css" type="text/css" />
    <link rel="stylesheet" href="http://95.sympy-live-tests.appspot.com/static/live-autocomplete.css" type="text/css" />
    <link rel="stylesheet" href="http://95.sympy-live-tests.appspot.com/static/live-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://95.sympy-live-tests.appspot.com/static/utilities.js"></script>
    <script type="text/javascript" src="http://95.sympy-live-tests.appspot.com/static/external/classy.js"></script>
    <script type="text/javascript" src="http://95.sympy-live-tests.appspot.com/static/live-core.js"></script>
    <script type="text/javascript" src="http://95.sympy-live-tests.appspot.com/static/live-autocomplete.js"></script>
    <script type="text/javascript" src="http://95.sympy-live-tests.appspot.com/static/live-sphinx.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML-full"></script>
    <link rel="shortcut icon" href="../_static/sympy-notailtext-favicon.ico"/>
    <link rel="top" title="SymPy 1.0 documentation" href="../index.html" />
    <link rel="up" title="SymPy Modules Reference" href="index.html" />
    <link rel="next" title="Concrete Mathematics" href="concrete.html" />
    <link rel="prev" title="Number Theory" href="ntheory.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="basic-cryptography-module">
<h1>Basic Cryptography Module<a class="headerlink" href="#basic-cryptography-module" title="Permalink to this headline">¶</a></h1>
<p>Encryption is the process of hiding a message and a cipher is a
means of doing so. Included in this module are both block and stream
ciphers:</p>
<blockquote>
<div><ul class="simple">
<li>Shift cipher</li>
<li>Affine cipher</li>
<li>substitution ciphers</li>
<li>Vigenere&#8217;s cipher</li>
<li>Hill&#8217;s cipher</li>
<li>Bifid ciphers</li>
<li>RSA</li>
<li>Kid RSA</li>
<li>linear-feedback shift registers (for stream ciphers)</li>
<li>ElGamal encryption</li>
</ul>
</div></blockquote>
<p>In a <em>substitution cipher</em> &#8220;units&#8221; (not necessarily single characters)
of plaintext are replaced with ciphertext according to a regular system.</p>
<p>A <em>transposition cipher</em> is a method of encryption by which
the positions held by &#8220;units&#8221; of plaintext are replaced by a
permutation of the plaintext. That is, the order of the units is
changed using a bijective function on the position of the characters
to perform the encryption.</p>
<p>A <em>monoalphabetic cipher</em> uses fixed substitution over the entire
message, whereas a <em>polyalphabetic cipher</em> uses a number of
substitutions at different times in the message.</p>
<span class="target" id="module-sympy.crypto.crypto"></span><dl class="function">
<dt id="sympy.crypto.crypto.AZ">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">AZ</code><span class="sig-paren">(</span><em>s=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#AZ"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.AZ" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the letters of <code class="docutils literal"><span class="pre">s</span></code> in uppercase. In case more than
one string is passed, each of them will be processed and a list
of upper case strings will be returned.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.crypto.crypto.check_and_join" title="sympy.crypto.crypto.check_and_join"><code class="xref py py-obj docutils literal"><span class="pre">check_and_join</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">AZ</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">AZ</span><span class="p">(</span><span class="s1">&#39;Hello, world!&#39;</span><span class="p">)</span>
<span class="go">&#39;HELLOWORLD&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">AZ</span><span class="p">(</span><span class="s1">&#39;Hello, world!&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
<span class="go">[&#39;HELLO&#39;, &#39;WORLD&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.padded_key">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">padded_key</code><span class="sig-paren">(</span><em>key</em>, <em>symbols</em>, <em>filter=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#padded_key"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.padded_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a string of the distinct characters of <code class="docutils literal"><span class="pre">symbols</span></code> with
those of <code class="docutils literal"><span class="pre">key</span></code> appearing first, omitting characters in <code class="docutils literal"><span class="pre">key</span></code>
that are not in <code class="docutils literal"><span class="pre">symbols</span></code>. A ValueError is raised if a) there are
duplicate characters in <code class="docutils literal"><span class="pre">symbols</span></code> or b) there are characters
in <code class="docutils literal"><span class="pre">key</span></code> that are  not in <code class="docutils literal"><span class="pre">symbols</span></code>.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">padded_key</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">padded_key</span><span class="p">(</span><span class="s1">&#39;PUPPY&#39;</span><span class="p">,</span> <span class="s1">&#39;OPQRSTUVWXY&#39;</span><span class="p">)</span>
<span class="go">&#39;PUYOQRSTVWX&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">padded_key</span><span class="p">(</span><span class="s1">&#39;RSA&#39;</span><span class="p">,</span> <span class="s1">&#39;ARTIST&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">duplicate characters in symbols: T</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.check_and_join">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">check_and_join</code><span class="sig-paren">(</span><em>phrase</em>, <em>symbols=None</em>, <em>filter=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#check_and_join"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.check_and_join" title="Permalink to this definition">¶</a></dt>
<dd><p>Joins characters of <span class="math">\(phrase\)</span> and if <code class="docutils literal"><span class="pre">symbols</span></code> is given, raises
an error if any character in <code class="docutils literal"><span class="pre">phrase</span></code> is not in <code class="docutils literal"><span class="pre">symbols</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>phrase:     string or list of strings to be returned as a string</strong></p>
<p><strong>symbols:    iterable of characters allowed in ``phrase``;</strong></p>
<blockquote class="last">
<div><p>if <code class="docutils literal"><span class="pre">symbols</span></code> is None, no checking is performed</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">check_and_join</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">check_and_join</span><span class="p">(</span><span class="s1">&#39;a phrase&#39;</span><span class="p">)</span>
<span class="go">&#39;a phrase&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">check_and_join</span><span class="p">(</span><span class="s1">&#39;a phrase&#39;</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
<span class="go">&#39;APHRASE&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">check_and_join</span><span class="p">(</span><span class="s1">&#39;a phrase!&#39;</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="s1">&#39;ARE&#39;</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;ARAE&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">check_and_join</span><span class="p">(</span><span class="s1">&#39;a phrase!&#39;</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="s1">&#39;ARE&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">characters in phrase but not symbols: &quot;!HPS&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.cycle_list">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">cycle_list</code><span class="sig-paren">(</span><em>k</em>, <em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#cycle_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.cycle_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the elements of the list <code class="docutils literal"><span class="pre">range(n)</span></code> shifted to the
left by <code class="docutils literal"><span class="pre">k</span></code> (so the list starts with <code class="docutils literal"><span class="pre">k</span></code> (mod <code class="docutils literal"><span class="pre">n</span></code>)).</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">cycle_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cycle_list</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">[3, 4, 5, 6, 7, 8, 9, 0, 1, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.encipher_shift">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">encipher_shift</code><span class="sig-paren">(</span><em>msg</em>, <em>key</em>, <em>symbols=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#encipher_shift"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.encipher_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs shift cipher encryption on plaintext msg, and returns the
ciphertext.</p>
<p class="rubric">Notes</p>
<p>The shift cipher is also called the Caesar cipher, after
Julius Caesar, who, according to Suetonius, used it with a
shift of three to protect messages of military significance.
Caesar&#8217;s nephew Augustus reportedly used a similar cipher, but
with a right shift of 1.</p>
<p>ALGORITHM:</p>
<blockquote>
<div><p>INPUT:</p>
<blockquote>
<div><p><code class="docutils literal"><span class="pre">key</span></code>: an integer (the secret key)</p>
<p><code class="docutils literal"><span class="pre">msg</span></code>: plaintext of upper-case letters</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><code class="docutils literal"><span class="pre">ct</span></code>: ciphertext of upper-case letters</div></blockquote>
<dl class="docutils">
<dt>STEPS:</dt>
<dd><ol class="first last arabic simple" start="0">
<li>Number the letters of the alphabet from 0, ..., N</li>
<li>Compute from the string <code class="docutils literal"><span class="pre">msg</span></code> a list <code class="docutils literal"><span class="pre">L1</span></code> of
corresponding integers.</li>
<li>Compute from the list <code class="docutils literal"><span class="pre">L1</span></code> a new list <code class="docutils literal"><span class="pre">L2</span></code>, given by
adding <code class="docutils literal"><span class="pre">(k</span> <span class="pre">mod</span> <span class="pre">26)</span></code> to each element in <code class="docutils literal"><span class="pre">L1</span></code>.</li>
<li>Compute from the list <code class="docutils literal"><span class="pre">L2</span></code> a string <code class="docutils literal"><span class="pre">ct</span></code> of
corresponding letters.</li>
</ol>
</dd>
</dl>
</div></blockquote>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">encipher_shift</span><span class="p">,</span> <span class="n">decipher_shift</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;GONAVYBEATARMY&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ct</span> <span class="o">=</span> <span class="n">encipher_shift</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="n">ct</span>
<span class="go">&#39;HPOBWZCFBUBSNZ&#39;</span>
</pre></div>
</div>
<p>To decipher the shifted text, change the sign of the key:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">encipher_shift</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&#39;GONAVYBEATARMY&#39;</span>
</pre></div>
</div>
<p>There is also a convenience function that does this with the
original key:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">decipher_shift</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">&#39;GONAVYBEATARMY&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.decipher_shift">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">decipher_shift</code><span class="sig-paren">(</span><em>msg</em>, <em>key</em>, <em>symbols=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#decipher_shift"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.decipher_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the text by shifting the characters of <code class="docutils literal"><span class="pre">msg</span></code> to the
left by the amount given by <code class="docutils literal"><span class="pre">key</span></code>.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">encipher_shift</span><span class="p">,</span> <span class="n">decipher_shift</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;GONAVYBEATARMY&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ct</span> <span class="o">=</span> <span class="n">encipher_shift</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="n">ct</span>
<span class="go">&#39;HPOBWZCFBUBSNZ&#39;</span>
</pre></div>
</div>
<p>To decipher the shifted text, change the sign of the key:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">encipher_shift</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&#39;GONAVYBEATARMY&#39;</span>
</pre></div>
</div>
<p>Or use this function with the original key:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">decipher_shift</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">&#39;GONAVYBEATARMY&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.encipher_affine">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">encipher_affine</code><span class="sig-paren">(</span><em>msg</em>, <em>key</em>, <em>symbols=None</em>, <em>_inverse=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#encipher_affine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.encipher_affine" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the affine cipher encryption on plaintext <code class="docutils literal"><span class="pre">msg</span></code>, and
returns the ciphertext.</p>
<p>Encryption is based on the map <span class="math">\(x \rightarrow ax+b\)</span> (mod <span class="math">\(N\)</span>)
where <code class="docutils literal"><span class="pre">N</span></code> is the number of characters in the alphabet.
Decryption is based on the map <span class="math">\(x \rightarrow cx+d\)</span> (mod <span class="math">\(N\)</span>),
where <span class="math">\(c = a^{-1}\)</span> (mod <span class="math">\(N\)</span>) and <span class="math">\(d = -a^{-1}b\)</span> (mod <span class="math">\(N\)</span>).
In particular, for the map to be invertible, we need
<span class="math">\(\mathrm{gcd}(a, N) = 1\)</span> and an error will be raised if this is
not true.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.crypto.crypto.decipher_affine" title="sympy.crypto.crypto.decipher_affine"><code class="xref py py-obj docutils literal"><span class="pre">decipher_affine</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>This is a straightforward generalization of the shift cipher with
the added complexity of requiring 2 characters to be deciphered in
order to recover the key.</p>
<p>ALGORITHM:</p>
<blockquote>
<div><p>INPUT:</p>
<blockquote>
<div><p><code class="docutils literal"><span class="pre">msg</span></code>: string of characters that appear in <code class="docutils literal"><span class="pre">symbols</span></code></p>
<p><code class="docutils literal"><span class="pre">a,</span> <span class="pre">b</span></code>: a pair integers, with <code class="docutils literal"><span class="pre">gcd(a,</span> <span class="pre">N)</span> <span class="pre">=</span> <span class="pre">1</span></code>
(the secret key)</p>
<p><code class="docutils literal"><span class="pre">symbols</span></code>: string of characters (default = uppercase
letters). When no symbols are given, <code class="docutils literal"><span class="pre">msg</span></code> is converted
to upper case letters and all other charactes are ignored.</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><code class="docutils literal"><span class="pre">ct</span></code>: string of characters (the ciphertext message)</div></blockquote>
<dl class="docutils">
<dt>STEPS:</dt>
<dd><ol class="first last arabic simple" start="0">
<li>Number the letters of the alphabet from 0, ..., N</li>
<li>Compute from the string <code class="docutils literal"><span class="pre">msg</span></code> a list <code class="docutils literal"><span class="pre">L1</span></code> of
corresponding integers.</li>
<li>Compute from the list <code class="docutils literal"><span class="pre">L1</span></code> a new list <code class="docutils literal"><span class="pre">L2</span></code>, given by
replacing <code class="docutils literal"><span class="pre">x</span></code> by <code class="docutils literal"><span class="pre">a*x</span> <span class="pre">+</span> <span class="pre">b</span> <span class="pre">(mod</span> <span class="pre">N)</span></code>, for each element
<code class="docutils literal"><span class="pre">x</span></code> in <code class="docutils literal"><span class="pre">L1</span></code>.</li>
<li>Compute from the list <code class="docutils literal"><span class="pre">L2</span></code> a string <code class="docutils literal"><span class="pre">ct</span></code> of
corresponding letters.</li>
</ol>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.decipher_affine">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">decipher_affine</code><span class="sig-paren">(</span><em>msg</em>, <em>key</em>, <em>symbols=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#decipher_affine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.decipher_affine" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the deciphered text that was made from the mapping,
<span class="math">\(x \rightarrow ax+b\)</span> (mod <span class="math">\(N\)</span>), where <code class="docutils literal"><span class="pre">N</span></code> is the
number of characters in the alphabet. Deciphering is done by
reciphering with a new key: <span class="math">\(x \rightarrow cx+d\)</span> (mod <span class="math">\(N\)</span>),
where <span class="math">\(c = a^{-1}\)</span> (mod <span class="math">\(N\)</span>) and <span class="math">\(d = -a^{-1}b\)</span> (mod <span class="math">\(N\)</span>).</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">encipher_affine</span><span class="p">,</span> <span class="n">decipher_affine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;GO NAVY BEAT ARMY&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encipher_affine</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="go">&#39;TROBMVENBGBALV&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decipher_affine</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="go">&#39;GONAVYBEATARMY&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.encipher_substitution">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">encipher_substitution</code><span class="sig-paren">(</span><em>msg</em>, <em>old</em>, <em>new=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#encipher_substitution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.encipher_substitution" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the ciphertext obtained by replacing each character that
appears in <code class="docutils literal"><span class="pre">old</span></code> with the corresponding character in <code class="docutils literal"><span class="pre">new</span></code>.
If <code class="docutils literal"><span class="pre">old</span></code> is a mapping, then new is ignored and the replacements
defined by <code class="docutils literal"><span class="pre">old</span></code> are used.</p>
<p class="rubric">Notes</p>
<p>This is a more general than the affine cipher in that the key can
only be recovered by determining the mapping for each symbol.
Though in practice, once a few symbols are recognized the mappings
for other characters can be quickly guessed.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">encipher_substitution</span><span class="p">,</span> <span class="n">AZ</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">old</span> <span class="o">=</span> <span class="s1">&#39;OEYAG&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new</span> <span class="o">=</span> <span class="s1">&#39;034^6&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span> <span class="o">=</span> <span class="n">AZ</span><span class="p">(</span><span class="s2">&quot;go navy! beat army!&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ct</span> <span class="o">=</span> <span class="n">encipher_substitution</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">);</span> <span class="n">ct</span>
<span class="go">&#39;60N^V4B3^T^RM4&#39;</span>
</pre></div>
</div>
<p>To decrypt a substitution, reverse the last two arguments:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">encipher_substitution</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="n">new</span><span class="p">,</span> <span class="n">old</span><span class="p">)</span>
<span class="go">&#39;GONAVYBEATARMY&#39;</span>
</pre></div>
</div>
<p>In the special case where <code class="docutils literal"><span class="pre">old</span></code> and <code class="docutils literal"><span class="pre">new</span></code> are a permuation of
order 2 (representing a transposition of characters) their order
is immaterial:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">old</span> <span class="o">=</span> <span class="s1">&#39;NAVY&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new</span> <span class="o">=</span> <span class="s1">&#39;ANYV&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encipher</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">encipher_substitution</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encipher</span><span class="p">(</span><span class="s1">&#39;NAVY&#39;</span><span class="p">)</span>
<span class="go">&#39;ANYV&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encipher</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">&#39;NAVY&#39;</span>
</pre></div>
</div>
<p>The substitution cipher, in general, is a method
whereby &#8220;units&#8221; (not necessarily single characters) of plaintext
are replaced with ciphertext according to a regular system.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ords</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;\</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">ord</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="s1">&#39;abc&#39;</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">encipher_substitution</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">,</span> <span class="n">ords</span><span class="p">))</span>
<span class="go">\97\98\99</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.encipher_vigenere">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">encipher_vigenere</code><span class="sig-paren">(</span><em>msg</em>, <em>key</em>, <em>symbols=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#encipher_vigenere"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.encipher_vigenere" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the Vigenère cipher encryption on plaintext <code class="docutils literal"><span class="pre">msg</span></code>, and
returns the ciphertext.</p>
<p class="rubric">Notes</p>
<p>The Vigenère cipher is named after Blaise de Vigenère, a sixteenth
century diplomat and cryptographer, by a historical accident.
Vigenère actually invented a different and more complicated cipher.
The so-called <em>Vigenère cipher</em> was actually invented
by Giovan Batista Belaso in 1553.</p>
<p>This cipher was used in the 1800&#8217;s, for example, during the American
Civil War. The Confederacy used a brass cipher disk to implement the
Vigenère cipher (now on display in the NSA Museum in Fort
Meade) <a class="reference internal" href="#r80" id="id1">[R80]</a>.</p>
<p>The Vigenère cipher is a generalization of the shift cipher.
Whereas the shift cipher shifts each letter by the same amount
(that amount being the key of the shift cipher) the Vigenère
cipher shifts a letter by an amount determined by the key (which is
a word or phrase known only to the sender and receiver).</p>
<p>For example, if the key was a single letter, such as &#8220;C&#8221;, then the
so-called Vigenere cipher is actually a shift cipher with a
shift of <span class="math">\(2\)</span> (since &#8220;C&#8221; is the 2nd letter of the alphabet, if
you start counting at <span class="math">\(0\)</span>). If the key was a word with two
letters, such as &#8220;CA&#8221;, then the so-called Vigenère cipher will
shift letters in even positions by <span class="math">\(2\)</span> and letters in odd positions
are left alone (shifted by <span class="math">\(0\)</span>, since &#8220;A&#8221; is the 0th letter, if
you start counting at <span class="math">\(0\)</span>).</p>
<p>ALGORITHM:</p>
<blockquote>
<div><p>INPUT:</p>
<blockquote>
<div><p><code class="docutils literal"><span class="pre">msg</span></code>: string of characters that appear in <code class="docutils literal"><span class="pre">symbols</span></code>
(the plaintext)</p>
<p><code class="docutils literal"><span class="pre">key</span></code>: a string of characters that appear in <code class="docutils literal"><span class="pre">symbols</span></code>
(the secret key)</p>
<p><code class="docutils literal"><span class="pre">symbols</span></code>: a string of letters defining the alphabet</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><code class="docutils literal"><span class="pre">ct</span></code>: string of characters (the ciphertext message)</div></blockquote>
<dl class="docutils">
<dt>STEPS:</dt>
<dd><ol class="first last arabic simple" start="0">
<li>Number the letters of the alphabet from 0, ..., N</li>
<li>Compute from the string <code class="docutils literal"><span class="pre">key</span></code> a list <code class="docutils literal"><span class="pre">L1</span></code> of
corresponding integers. Let <code class="docutils literal"><span class="pre">n1</span> <span class="pre">=</span> <span class="pre">len(L1)</span></code>.</li>
<li>Compute from the string <code class="docutils literal"><span class="pre">msg</span></code> a list <code class="docutils literal"><span class="pre">L2</span></code> of
corresponding integers. Let <code class="docutils literal"><span class="pre">n2</span> <span class="pre">=</span> <span class="pre">len(L2)</span></code>.</li>
<li>Break <code class="docutils literal"><span class="pre">L2</span></code> up sequencially into sublists of size
<code class="docutils literal"><span class="pre">n1</span></code>; the last sublist may be smaller than <code class="docutils literal"><span class="pre">n1</span></code></li>
<li>For each of these sublists <code class="docutils literal"><span class="pre">L</span></code> of <code class="docutils literal"><span class="pre">L2</span></code>, compute a
new list <code class="docutils literal"><span class="pre">C</span></code> given by <code class="docutils literal"><span class="pre">C[i]</span> <span class="pre">=</span> <span class="pre">L[i]</span> <span class="pre">+</span> <span class="pre">L1[i]</span> <span class="pre">(mod</span> <span class="pre">N)</span></code>
to the <code class="docutils literal"><span class="pre">i</span></code>-th element in the sublist, for each <code class="docutils literal"><span class="pre">i</span></code>.</li>
<li>Assemble these lists <code class="docutils literal"><span class="pre">C</span></code> by concatenation into a new
list of length <code class="docutils literal"><span class="pre">n2</span></code>.</li>
<li>Compute from the new list a string <code class="docutils literal"><span class="pre">ct</span></code> of
corresponding letters.</li>
</ol>
</dd>
</dl>
</div></blockquote>
<p>Once it is known that the key is, say, <span class="math">\(n\)</span> characters long,
frequency analysis can be applied to every <span class="math">\(n\)</span>-th letter of
the ciphertext to determine the plaintext. This method is
called <em>Kasiski examination</em> (although it was first discovered
by Babbage). If they key is as long as the message and is
comprised of randomly selected characters &#8211; a one-time pad &#8211; the
message is theoretically unbreakable.</p>
<p>The cipher Vigenère actually discovered is an &#8220;auto-key&#8221; cipher
described as follows.</p>
<p>ALGORITHM:</p>
<blockquote>
<div><p>INPUT:</p>
<blockquote>
<div><p><code class="docutils literal"><span class="pre">key</span></code>: a string of letters (the secret key)</p>
<p><code class="docutils literal"><span class="pre">msg</span></code>: string of letters (the plaintext message)</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><code class="docutils literal"><span class="pre">ct</span></code>: string of upper-case letters (the ciphertext message)</div></blockquote>
<dl class="docutils">
<dt>STEPS:</dt>
<dd><ol class="first last arabic simple" start="0">
<li>Number the letters of the alphabet from 0, ..., N</li>
<li>Compute from the string <code class="docutils literal"><span class="pre">msg</span></code> a list <code class="docutils literal"><span class="pre">L2</span></code> of
corresponding integers. Let <code class="docutils literal"><span class="pre">n2</span> <span class="pre">=</span> <span class="pre">len(L2)</span></code>.</li>
<li>Let <code class="docutils literal"><span class="pre">n1</span></code> be the length of the key. Append to the
string <code class="docutils literal"><span class="pre">key</span></code> the first <code class="docutils literal"><span class="pre">n2</span> <span class="pre">-</span> <span class="pre">n1</span></code> characters of
the plaintext message. Compute from this string (also of
length <code class="docutils literal"><span class="pre">n2</span></code>) a list <code class="docutils literal"><span class="pre">L1</span></code> of integers corresponding
to the letter numbers in the first step.</li>
<li>Compute a new list <code class="docutils literal"><span class="pre">C</span></code> given by
<code class="docutils literal"><span class="pre">C[i]</span> <span class="pre">=</span> <span class="pre">L1[i]</span> <span class="pre">+</span> <span class="pre">L2[i]</span> <span class="pre">(mod</span> <span class="pre">N)</span></code>.</li>
<li>Compute from the new list a string <code class="docutils literal"><span class="pre">ct</span></code> of letters
corresponding to the new integers.</li>
</ol>
</dd>
</dl>
</div></blockquote>
<p>To decipher the auto-key ciphertext, the key is used to decipher
the first <code class="docutils literal"><span class="pre">n1</span></code> characters and then those characters become the
key to  decipher the next <code class="docutils literal"><span class="pre">n1</span></code> characters, etc...:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">AZ</span><span class="p">(</span><span class="s1">&#39;go navy, beat army! yes you can&#39;</span><span class="p">);</span> <span class="n">m</span>
<span class="go">&#39;GONAVYBEATARMYYESYOUCAN&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="n">AZ</span><span class="p">(</span><span class="s1">&#39;gold bug&#39;</span><span class="p">);</span> <span class="n">n1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">);</span> <span class="n">n2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">auto_key</span> <span class="o">=</span> <span class="n">key</span> <span class="o">+</span> <span class="n">m</span><span class="p">[:</span><span class="n">n2</span> <span class="o">-</span> <span class="n">n1</span><span class="p">];</span> <span class="n">auto_key</span>
<span class="go">&#39;GOLDBUGGONAVYBEATARMYYE&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ct</span> <span class="o">=</span> <span class="n">encipher_vigenere</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">auto_key</span><span class="p">);</span> <span class="n">ct</span>
<span class="go">&#39;MCYDWSHKOGAMKZCELYFGAYR&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">while</span> <span class="n">ct</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">part</span><span class="p">,</span> <span class="n">ct</span> <span class="o">=</span> <span class="n">ct</span><span class="p">[:</span><span class="n">n1</span><span class="p">],</span> <span class="n">ct</span><span class="p">[</span><span class="n">n1</span><span class="p">:]</span>
<span class="gp">... </span>    <span class="n">pt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">decipher_vigenere</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">key</span> <span class="o">=</span> <span class="n">pt</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="o">==</span> <span class="n">m</span>
<span class="go">True</span>
</pre></div>
</div>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r80" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R80]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id2">2</a>)</em> <a class="reference external" href="http://en.wikipedia.org/wiki/Vigenere_cipher">http://en.wikipedia.org/wiki/Vigenere_cipher</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r81" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R81]</td><td><em>(<a class="fn-backref" href="#id3">1</a>, <a class="fn-backref" href="#id4">2</a>)</em> <a class="reference external" href="http://web.archive.org/web/20071116100808/">http://web.archive.org/web/20071116100808/</a>
<a class="reference external" href="http://filebox.vt.edu/users/batman/kryptos.html">http://filebox.vt.edu/users/batman/kryptos.html</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">encipher_vigenere</span><span class="p">,</span> <span class="n">AZ</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;encrypt&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;meet me on monday&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encipher_vigenere</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="go">&#39;QRGKKTHRZQEBPR&#39;</span>
</pre></div>
</div>
<p>Section 1 of the Kryptos sculpture at the CIA headquarters
uses this cipher and also changes the order of the the
alphabet <a class="reference internal" href="#r81" id="id4">[R81]</a>. Here is the first line of that section of
the sculpture:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">decipher_vigenere</span><span class="p">,</span> <span class="n">padded_key</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alp</span> <span class="o">=</span> <span class="n">padded_key</span><span class="p">(</span><span class="s1">&#39;KRYPTOS&#39;</span><span class="p">,</span> <span class="n">AZ</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;PALIMPSEST&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;EMUFPHZLRFAXYUSDJKZLDKRNSHGNFIVJ&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decipher_vigenere</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">alp</span><span class="p">)</span>
<span class="go">&#39;BETWEENSUBTLESHADINGANDTHEABSENC&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.decipher_vigenere">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">decipher_vigenere</code><span class="sig-paren">(</span><em>msg</em>, <em>key</em>, <em>symbols=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#decipher_vigenere"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.decipher_vigenere" title="Permalink to this definition">¶</a></dt>
<dd><p>Decode using the Vigenère cipher.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">decipher_vigenere</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;encrypt&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ct</span> <span class="o">=</span> <span class="s2">&quot;QRGK kt HRZQE BPR&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decipher_vigenere</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="go">&#39;MEETMEONMONDAY&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.encipher_hill">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">encipher_hill</code><span class="sig-paren">(</span><em>msg</em>, <em>key</em>, <em>symbols=None</em>, <em>pad='Q'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#encipher_hill"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.encipher_hill" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Hill cipher encryption of <code class="docutils literal"><span class="pre">msg</span></code>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.crypto.crypto.decipher_hill" title="sympy.crypto.crypto.decipher_hill"><code class="xref py py-obj docutils literal"><span class="pre">decipher_hill</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>The Hill cipher <a class="reference internal" href="#r82" id="id5">[R82]</a>, invented by Lester S. Hill in the 1920&#8217;s <a class="reference internal" href="#r83" id="id6">[R83]</a>,
was the first polygraphic cipher in which it was practical
(though barely) to operate on more than three symbols at once.
The following discussion assumes an elementary knowledge of
matrices.</p>
<p>First, each letter is first encoded as a number starting with 0.
Suppose your message <span class="math">\(msg\)</span> consists of <span class="math">\(n\)</span> capital letters, with no
spaces. This may be regarded an <span class="math">\(n\)</span>-tuple M of elements of
<span class="math">\(Z_{26}\)</span> (if the letters are those of the English alphabet). A key
in the Hill cipher is a <span class="math">\(k x k\)</span> matrix <span class="math">\(K\)</span>, all of whose entries
are in <span class="math">\(Z_{26}\)</span>, such that the matrix <span class="math">\(K\)</span> is invertible (i.e., the
linear transformation <span class="math">\(K: Z_{N}^k \rightarrow Z_{N}^k\)</span>
is one-to-one).</p>
<p>ALGORITHM:</p>
<blockquote>
<div><p>INPUT:</p>
<blockquote>
<div><p><code class="docutils literal"><span class="pre">msg</span></code>: plaintext message of <span class="math">\(n\)</span> upper-case letters</p>
<p><code class="docutils literal"><span class="pre">key</span></code>: a <span class="math">\(k x k\)</span> invertible matrix <span class="math">\(K\)</span>, all of whose
entries are in <span class="math">\(Z_{26}\)</span> (or whatever number of symbols
are being used).</p>
<p><code class="docutils literal"><span class="pre">pad</span></code>: character (default &#8220;Q&#8221;) to use to make length
of text be a multiple of <code class="docutils literal"><span class="pre">k</span></code></p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><code class="docutils literal"><span class="pre">ct</span></code>: ciphertext of upper-case letters</div></blockquote>
<dl class="docutils">
<dt>STEPS:</dt>
<dd><ol class="first last arabic simple" start="0">
<li>Number the letters of the alphabet from 0, ..., N</li>
<li>Compute from the string <code class="docutils literal"><span class="pre">msg</span></code> a list <code class="docutils literal"><span class="pre">L</span></code> of
corresponding integers. Let <code class="docutils literal"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">len(L)</span></code>.</li>
<li>Break the list <code class="docutils literal"><span class="pre">L</span></code> up into <code class="docutils literal"><span class="pre">t</span> <span class="pre">=</span> <span class="pre">ceiling(n/k)</span></code>
sublists <code class="docutils literal"><span class="pre">L_1</span></code>, ..., <code class="docutils literal"><span class="pre">L_t</span></code> of size <code class="docutils literal"><span class="pre">k</span></code> (with
the last list &#8220;padded&#8221; to ensure its size is
<code class="docutils literal"><span class="pre">k</span></code>).</li>
<li>Compute new list <code class="docutils literal"><span class="pre">C_1</span></code>, ..., <code class="docutils literal"><span class="pre">C_t</span></code> given by
<code class="docutils literal"><span class="pre">C[i]</span> <span class="pre">=</span> <span class="pre">K*L_i</span></code> (arithmetic is done mod N), for each
<code class="docutils literal"><span class="pre">i</span></code>.</li>
<li>Concatenate these into a list <code class="docutils literal"><span class="pre">C</span> <span class="pre">=</span> <span class="pre">C_1</span> <span class="pre">+</span> <span class="pre">...</span> <span class="pre">+</span> <span class="pre">C_t</span></code>.</li>
<li>Compute from <code class="docutils literal"><span class="pre">C</span></code> a string <code class="docutils literal"><span class="pre">ct</span></code> of corresponding
letters. This has length <code class="docutils literal"><span class="pre">k*t</span></code>.</li>
</ol>
</dd>
</dl>
</div></blockquote>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r82" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R82]</td><td><em>(<a class="fn-backref" href="#id5">1</a>, <a class="fn-backref" href="#id7">2</a>)</em> en.wikipedia.org/wiki/Hill_cipher</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r83" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R83]</td><td><em>(<a class="fn-backref" href="#id6">1</a>, <a class="fn-backref" href="#id8">2</a>)</em> Lester S. Hill, Cryptography in an Algebraic Alphabet,
The American Mathematical Monthly Vol.36, June-July 1929,
pp.306-312.</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.decipher_hill">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">decipher_hill</code><span class="sig-paren">(</span><em>msg</em>, <em>key</em>, <em>symbols=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#decipher_hill"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.decipher_hill" title="Permalink to this definition">¶</a></dt>
<dd><p>Deciphering is the same as enciphering but using the inverse of the
key matrix.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">encipher_hill</span><span class="p">,</span> <span class="n">decipher_hill</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">Matrix</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encipher_hill</span><span class="p">(</span><span class="s2">&quot;meet me on monday&quot;</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="go">&#39;UEQDUEODOCTCWQ&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decipher_hill</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="go">&#39;MEETMEONMONDAY&#39;</span>
</pre></div>
</div>
<p>When the length of the plaintext (stripped of invalid characters)
is not a multiple of the key dimension, extra characters will
appear at the end of the enciphered and deciphered text. In order to
decipher the text, those characters must be included in the text to
be deciphered. In the following, the key has a dimension of 4 but
the text is 2 short of being a multiple of 4 so two characters will
be added.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;ST&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encipher_hill</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="go">&#39;HJEB&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decipher_hill</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="go">&#39;STQQ&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encipher_hill</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="s2">&quot;Z&quot;</span><span class="p">)</span>
<span class="go">&#39;ISPK&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decipher_hill</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="go">&#39;STZZ&#39;</span>
</pre></div>
</div>
<p>If the last two characters of the ciphertext were ignored in
either case, the wrong plaintext would be recovered:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">decipher_hill</span><span class="p">(</span><span class="s2">&quot;HD&quot;</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="go">&#39;ORMV&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decipher_hill</span><span class="p">(</span><span class="s2">&quot;IS&quot;</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="go">&#39;UIKY&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.encipher_bifid">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">encipher_bifid</code><span class="sig-paren">(</span><em>msg</em>, <em>key</em>, <em>symbols=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#encipher_bifid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.encipher_bifid" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the Bifid cipher encryption on plaintext <code class="docutils literal"><span class="pre">msg</span></code>, and
returns the ciphertext.</p>
<p>This is the version of the Bifid cipher that uses an <span class="math">\(n \times n\)</span>
Polybius square.</p>
<blockquote>
<div><p>INPUT:</p>
<blockquote>
<div><p><code class="docutils literal"><span class="pre">msg</span></code>: plaintext string</p>
<p><code class="docutils literal"><span class="pre">key</span></code>: short string for key; duplicate characters are
ignored and then it is padded with the characters in
<code class="docutils literal"><span class="pre">symbols</span></code> that were not in the short key</p>
<p><code class="docutils literal"><span class="pre">symbols</span></code>: <span class="math">\(n \times n\)</span> characters defining the alphabet
(default is string.printable)</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div>ciphertext (using Bifid5 cipher without spaces)</div></blockquote>
</div></blockquote>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.crypto.crypto.decipher_bifid" title="sympy.crypto.crypto.decipher_bifid"><code class="xref py py-obj docutils literal"><span class="pre">decipher_bifid</span></code></a>, <a class="reference internal" href="#sympy.crypto.crypto.encipher_bifid5" title="sympy.crypto.crypto.encipher_bifid5"><code class="xref py py-obj docutils literal"><span class="pre">encipher_bifid5</span></code></a>, <a class="reference internal" href="#sympy.crypto.crypto.encipher_bifid6" title="sympy.crypto.crypto.encipher_bifid6"><code class="xref py py-obj docutils literal"><span class="pre">encipher_bifid6</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.decipher_bifid">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">decipher_bifid</code><span class="sig-paren">(</span><em>msg</em>, <em>key</em>, <em>symbols=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#decipher_bifid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.decipher_bifid" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the Bifid cipher decryption on ciphertext <code class="docutils literal"><span class="pre">msg</span></code>, and
returns the plaintext.</p>
<p>This is the version of the Bifid cipher that uses the <span class="math">\(n \times n\)</span>
Polybius square.</p>
<blockquote>
<div><p>INPUT:</p>
<blockquote>
<div><p><code class="docutils literal"><span class="pre">msg</span></code>: ciphertext string</p>
<p><code class="docutils literal"><span class="pre">key</span></code>: short string for key; duplicate characters are
ignored and then it is padded with the characters in
<code class="docutils literal"><span class="pre">symbols</span></code> that were not in the short key</p>
<p><code class="docutils literal"><span class="pre">symbols</span></code>: <span class="math">\(n \times n\)</span> characters defining the alphabet
(default=string.printable, a <span class="math">\(10 \times 10\)</span> matrix)</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div>deciphered text</div></blockquote>
</div></blockquote>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">encipher_bifid</span><span class="p">,</span> <span class="n">decipher_bifid</span><span class="p">,</span> <span class="n">AZ</span><span class="p">)</span>
</pre></div>
</div>
<p>Do an encryption using the bifid5 alphabet:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">alp</span> <span class="o">=</span> <span class="n">AZ</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;J&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ct</span> <span class="o">=</span> <span class="n">AZ</span><span class="p">(</span><span class="s2">&quot;meet me on monday!&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="n">AZ</span><span class="p">(</span><span class="s2">&quot;gold bug&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encipher_bifid</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">alp</span><span class="p">)</span>
<span class="go">&#39;IEILHHFSTSFQYE&#39;</span>
</pre></div>
</div>
<p>When entering the text or ciphertext, spaces are ignored so it
can be formatted as desired. Re-entering the ciphertext from the
preceding, putting 4 characters per line and padding with an extra
J, does not cause problems for the deciphering:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">decipher_bifid</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s1">IEILH</span>
<span class="gp">... </span><span class="s1">HFSTS</span>
<span class="gp">... </span><span class="s1">FQYEJ&#39;&#39;&#39;</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">alp</span><span class="p">)</span>
<span class="go">&#39;MEETMEONMONDAY&#39;</span>
</pre></div>
</div>
<p>When no alphabet is given, all 100 printable characters will be
used:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encipher_bifid</span><span class="p">(</span><span class="s1">&#39;hello world!&#39;</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="go">&#39;bmtwmg-bIo*w&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decipher_bifid</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="go">&#39;hello world!&#39;</span>
</pre></div>
</div>
<p>If the key is changed, a different encryption is obtained:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;gold bug&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encipher_bifid</span><span class="p">(</span><span class="s1">&#39;hello world!&#39;</span><span class="p">,</span> <span class="s1">&#39;gold_bug&#39;</span><span class="p">)</span>
<span class="go">&#39;hg2sfuei7t}w&#39;</span>
</pre></div>
</div>
<p>And if the key used to decrypt the message is not exact, the
original text will not be perfectly obtained:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">decipher_bifid</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="s1">&#39;gold pug&#39;</span><span class="p">)</span>
<span class="go">&#39;heldo~wor6d!&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.bifid5_square">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">bifid5_square</code><span class="sig-paren">(</span><em>key=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#bifid5_square"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.bifid5_square" title="Permalink to this definition">¶</a></dt>
<dd><p>5x5 Polybius square.</p>
<p>Produce the Polybius square for the <span class="math">\(5 \times 5\)</span> Bifid cipher.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">bifid5_square</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bifid5_square</span><span class="p">(</span><span class="s2">&quot;gold bug&quot;</span><span class="p">)</span>
<span class="go">Matrix([</span>
<span class="go">[G, O, L, D, B],</span>
<span class="go">[U, A, C, E, F],</span>
<span class="go">[H, I, K, M, N],</span>
<span class="go">[P, Q, R, S, T],</span>
<span class="go">[V, W, X, Y, Z]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.encipher_bifid5">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">encipher_bifid5</code><span class="sig-paren">(</span><em>msg</em>, <em>key</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#encipher_bifid5"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.encipher_bifid5" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the Bifid cipher encryption on plaintext <code class="docutils literal"><span class="pre">msg</span></code>, and
returns the ciphertext.</p>
<p>This is the version of the Bifid cipher that uses the <span class="math">\(5 \times 5\)</span>
Polybius square. The letter &#8220;J&#8221; is ignored so it must be replaced
with something else (traditionally an &#8220;I&#8221;) before encryption.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.crypto.crypto.decipher_bifid5" title="sympy.crypto.crypto.decipher_bifid5"><code class="xref py py-obj docutils literal"><span class="pre">decipher_bifid5</span></code></a>, <a class="reference internal" href="#sympy.crypto.crypto.encipher_bifid" title="sympy.crypto.crypto.encipher_bifid"><code class="xref py py-obj docutils literal"><span class="pre">encipher_bifid</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>The Bifid cipher was invented around 1901 by Felix Delastelle.
It is a <em>fractional substitution</em> cipher, where letters are
replaced by pairs of symbols from a smaller alphabet. The
cipher uses a <span class="math">\(5 \times 5\)</span> square filled with some ordering of the
alphabet, except that &#8220;J&#8221; is replaced with &#8220;I&#8221; (this is a so-called
Polybius square; there is a <span class="math">\(6 \times 6\)</span> analog if you add back in
&#8220;J&#8221; and also append onto the usual 26 letter alphabet, the digits
0, 1, ..., 9).
According to Helen Gaines&#8217; book <em>Cryptanalysis</em>, this type of cipher
was used in the field by the German Army during World War I.</p>
<p>ALGORITHM: (5x5 case)</p>
<blockquote>
<div><p>INPUT:</p>
<blockquote>
<div><p><code class="docutils literal"><span class="pre">msg</span></code>: plaintext string; converted to upper case and
filtered of anything but all letters except J.</p>
<p><code class="docutils literal"><span class="pre">key</span></code>: short string for key; non-alphabetic letters, J
and duplicated characters are ignored and then, if the
length is less than 25 characters, it is padded with other
letters of the alphabet (in alphabetical order).</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div>ciphertext (all caps, no spaces)</div></blockquote>
<dl class="docutils">
<dt>STEPS:</dt>
<dd><ol class="first last arabic" start="0">
<li><p class="first">Create the <span class="math">\(5 \times 5\)</span> Polybius square <code class="docutils literal"><span class="pre">S</span></code> associated
to <code class="docutils literal"><span class="pre">key</span></code> as follows:</p>
<blockquote>
<div><ol class="loweralpha simple">
<li>moving from left-to-right, top-to-bottom,
place the letters of the key into a <span class="math">\(5 \times 5\)</span>
matrix,</li>
<li>if the key has less than 25 letters, add the
letters of the alphabet not in the key until the
<span class="math">\(5 \times 5\)</span> square is filled.</li>
</ol>
</div></blockquote>
</li>
<li><p class="first">Create a list <code class="docutils literal"><span class="pre">P</span></code> of pairs of numbers which are the
coordinates in the Polybius square of the letters in
<code class="docutils literal"><span class="pre">msg</span></code>.</p>
</li>
<li><p class="first">Let <code class="docutils literal"><span class="pre">L1</span></code> be the list of all first coordinates of <code class="docutils literal"><span class="pre">P</span></code>
(length of <code class="docutils literal"><span class="pre">L1</span> <span class="pre">=</span> <span class="pre">n</span></code>), let <code class="docutils literal"><span class="pre">L2</span></code> be the list of all
second coordinates of <code class="docutils literal"><span class="pre">P</span></code> (so the length of <code class="docutils literal"><span class="pre">L2</span></code>
is also <code class="docutils literal"><span class="pre">n</span></code>).</p>
</li>
<li><p class="first">Let <code class="docutils literal"><span class="pre">L</span></code> be the concatenation of <code class="docutils literal"><span class="pre">L1</span></code> and <code class="docutils literal"><span class="pre">L2</span></code>
(length <code class="docutils literal"><span class="pre">L</span> <span class="pre">=</span> <span class="pre">2*n</span></code>), except that consecutive numbers
are paired <code class="docutils literal"><span class="pre">(L[2*i],</span> <span class="pre">L[2*i</span> <span class="pre">+</span> <span class="pre">1])</span></code>. You can regard
<code class="docutils literal"><span class="pre">L</span></code> as a list of pairs of length <code class="docutils literal"><span class="pre">n</span></code>.</p>
</li>
<li><p class="first">Let <code class="docutils literal"><span class="pre">C</span></code> be the list of all letters which are of the
form <code class="docutils literal"><span class="pre">S[i,</span> <span class="pre">j]</span></code>, for all <code class="docutils literal"><span class="pre">(i,</span> <span class="pre">j)</span></code> in <code class="docutils literal"><span class="pre">L</span></code>. As a
string, this is the ciphertext of <code class="docutils literal"><span class="pre">msg</span></code>.</p>
</li>
</ol>
</dd>
</dl>
</div></blockquote>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">encipher_bifid5</span><span class="p">,</span> <span class="n">decipher_bifid5</span><span class="p">)</span>
</pre></div>
</div>
<p>&#8220;J&#8221; will be omitted unless it is replaced with somthing else:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">round_trip</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> \
<span class="gp">... </span>    <span class="n">decipher_bifid5</span><span class="p">(</span><span class="n">encipher_bifid5</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">k</span><span class="p">),</span> <span class="n">k</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;JOSIE&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_trip</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="go">&#39;OSIE&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_trip</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;J&quot;</span><span class="p">,</span> <span class="s2">&quot;I&quot;</span><span class="p">),</span> <span class="n">key</span><span class="p">)</span>
<span class="go">&#39;IOSIE&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">j</span> <span class="o">=</span> <span class="s2">&quot;QIQ&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_trip</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;J&quot;</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="s2">&quot;J&quot;</span><span class="p">)</span>
<span class="go">&#39;JOSIE&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.decipher_bifid5">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">decipher_bifid5</code><span class="sig-paren">(</span><em>msg</em>, <em>key</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#decipher_bifid5"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.decipher_bifid5" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Bifid cipher decryption of <code class="docutils literal"><span class="pre">msg</span></code>.</p>
<p>This is the version of the Bifid cipher that uses the <span class="math">\(5 \times 5\)</span>
Polybius square; the letter &#8220;J&#8221; is ignored unless a <code class="docutils literal"><span class="pre">key</span></code> of
length 25 is used.</p>
<p>INPUT:</p>
<blockquote>
<div><p><code class="docutils literal"><span class="pre">msg</span></code>: ciphertext string</p>
<p><code class="docutils literal"><span class="pre">key</span></code>: short string for key; duplicated characters are
ignored and if the length is less then 25 characters, it
will be padded with other letters from the alphabet omitting
&#8220;J&#8221;. Non-alphabetic characters are ignored.</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div>plaintext from Bifid5 cipher (all caps, no spaces)</div></blockquote>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">encipher_bifid5</span><span class="p">,</span> <span class="n">decipher_bifid5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;gold bug&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encipher_bifid5</span><span class="p">(</span><span class="s1">&#39;meet me on friday&#39;</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="go">&#39;IEILEHFSTSFXEE&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encipher_bifid5</span><span class="p">(</span><span class="s1">&#39;meet me on monday&#39;</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="go">&#39;IEILHHFSTSFQYE&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decipher_bifid5</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="go">&#39;MEETMEONMONDAY&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">bifid5_square</code><span class="sig-paren">(</span><em>key=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#bifid5_square"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>5x5 Polybius square.</p>
<p>Produce the Polybius square for the <span class="math">\(5 \times 5\)</span> Bifid cipher.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">bifid5_square</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bifid5_square</span><span class="p">(</span><span class="s2">&quot;gold bug&quot;</span><span class="p">)</span>
<span class="go">Matrix([</span>
<span class="go">[G, O, L, D, B],</span>
<span class="go">[U, A, C, E, F],</span>
<span class="go">[H, I, K, M, N],</span>
<span class="go">[P, Q, R, S, T],</span>
<span class="go">[V, W, X, Y, Z]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.encipher_bifid6">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">encipher_bifid6</code><span class="sig-paren">(</span><em>msg</em>, <em>key</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#encipher_bifid6"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.encipher_bifid6" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the Bifid cipher encryption on plaintext <code class="docutils literal"><span class="pre">msg</span></code>, and
returns the ciphertext.</p>
<p>This is the version of the Bifid cipher that uses the <span class="math">\(6 \times 6\)</span>
Polybius square.</p>
<p>INPUT:</p>
<blockquote>
<div><p><code class="docutils literal"><span class="pre">msg</span></code>: plaintext string (digits okay)</p>
<p><code class="docutils literal"><span class="pre">key</span></code>: short string for key (digits okay). If <code class="docutils literal"><span class="pre">key</span></code> is
less than 36 characters long, the square will be filled with
letters A through Z and digits 0 through 9.</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div>ciphertext from Bifid cipher (all caps, no spaces)</div></blockquote>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.crypto.crypto.decipher_bifid6" title="sympy.crypto.crypto.decipher_bifid6"><code class="xref py py-obj docutils literal"><span class="pre">decipher_bifid6</span></code></a>, <a class="reference internal" href="#sympy.crypto.crypto.encipher_bifid" title="sympy.crypto.crypto.encipher_bifid"><code class="xref py py-obj docutils literal"><span class="pre">encipher_bifid</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.decipher_bifid6">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">decipher_bifid6</code><span class="sig-paren">(</span><em>msg</em>, <em>key</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#decipher_bifid6"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.decipher_bifid6" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the Bifid cipher decryption on ciphertext <code class="docutils literal"><span class="pre">msg</span></code>, and
returns the plaintext.</p>
<p>This is the version of the Bifid cipher that uses the <span class="math">\(6 \times 6\)</span>
Polybius square.</p>
<p>INPUT:</p>
<blockquote>
<div><p><code class="docutils literal"><span class="pre">msg</span></code>: ciphertext string (digits okay); converted to upper case</p>
<p><code class="docutils literal"><span class="pre">key</span></code>: short string for key (digits okay). If <code class="docutils literal"><span class="pre">key</span></code> is
less than 36 characters long, the square will be filled with
letters A through Z and digits 0 through 9. All letters are
converted to uppercase.</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div>plaintext from Bifid cipher (all caps, no spaces)</div></blockquote>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">encipher_bifid6</span><span class="p">,</span> <span class="n">decipher_bifid6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;gold bug&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encipher_bifid6</span><span class="p">(</span><span class="s1">&#39;meet me on monday at 8am&#39;</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="go">&#39;KFKLJJHF5MMMKTFRGPL&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decipher_bifid6</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="go">&#39;MEETMEONMONDAYAT8AM&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.bifid6_square">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">bifid6_square</code><span class="sig-paren">(</span><em>key=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#bifid6_square"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.bifid6_square" title="Permalink to this definition">¶</a></dt>
<dd><p>6x6 Polybius square.</p>
<p>Produces the Polybius square for the <span class="math">\(6 \times 6\)</span> Bifid cipher.
Assumes alphabet of symbols is &#8220;A&#8221;, ..., &#8220;Z&#8221;, &#8220;0&#8221;, ..., &#8220;9&#8221;.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">bifid6_square</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;gold bug&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bifid6_square</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="go">Matrix([</span>
<span class="go">[G, O, L, D, B, U],</span>
<span class="go">[A, C, E, F, H, I],</span>
<span class="go">[J, K, M, N, P, Q],</span>
<span class="go">[R, S, T, V, W, X],</span>
<span class="go">[Y, Z, 0, 1, 2, 3],</span>
<span class="go">[4, 5, 6, 7, 8, 9]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.rsa_public_key">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">rsa_public_key</code><span class="sig-paren">(</span><em>p</em>, <em>q</em>, <em>e</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#rsa_public_key"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.rsa_public_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the RSA <em>public key</em> pair, <span class="math">\((n, e)\)</span>, where <span class="math">\(n\)</span>
is a product of two primes and <span class="math">\(e\)</span> is relatively
prime (coprime) to the Euler totient <span class="math">\(\phi(n)\)</span>. False
is returned if any assumption is violated.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">rsa_public_key</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsa_public_key</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
<span class="go">(15, 7)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsa_public_key</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.rsa_private_key">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">rsa_private_key</code><span class="sig-paren">(</span><em>p</em>, <em>q</em>, <em>e</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#rsa_private_key"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.rsa_private_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the RSA <em>private key</em>, <span class="math">\((n,d)\)</span>, where <span class="math">\(n\)</span>
is a product of two primes and <span class="math">\(d\)</span> is the inverse of
<span class="math">\(e\)</span> (mod <span class="math">\(\phi(n)\)</span>). False is returned if any assumption
is violated.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">rsa_private_key</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsa_private_key</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
<span class="go">(15, 7)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsa_private_key</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.encipher_rsa">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">encipher_rsa</code><span class="sig-paren">(</span><em>i</em>, <em>key</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#encipher_rsa"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.encipher_rsa" title="Permalink to this definition">¶</a></dt>
<dd><p>Return encryption of <code class="docutils literal"><span class="pre">i</span></code> by computing <span class="math">\(i^e\)</span> (mod <span class="math">\(n\)</span>),
where <code class="docutils literal"><span class="pre">key</span></code> is the public key <span class="math">\((n, e)\)</span>.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">encipher_rsa</span><span class="p">,</span> <span class="n">rsa_public_key</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">puk</span> <span class="o">=</span> <span class="n">rsa_public_key</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span> <span class="o">=</span> <span class="mi">12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encipher_rsa</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">puk</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.decipher_rsa">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">decipher_rsa</code><span class="sig-paren">(</span><em>i</em>, <em>key</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#decipher_rsa"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.decipher_rsa" title="Permalink to this definition">¶</a></dt>
<dd><p>Return decyption of <code class="docutils literal"><span class="pre">i</span></code> by computing <span class="math">\(i^d\)</span> (mod <span class="math">\(n\)</span>),
where <code class="docutils literal"><span class="pre">key</span></code> is the private key <span class="math">\((n, d)\)</span>.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">decipher_rsa</span><span class="p">,</span> <span class="n">rsa_private_key</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prk</span> <span class="o">=</span> <span class="n">rsa_private_key</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decipher_rsa</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">prk</span><span class="p">)</span>
<span class="go">12</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.kid_rsa_public_key">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">kid_rsa_public_key</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>A</em>, <em>B</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#kid_rsa_public_key"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.kid_rsa_public_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Kid RSA is a version of RSA useful to teach grade school children
since it does not involve exponentiation.</p>
<p>Alice wants to talk to Bob. Bob generates keys as follows.
Key generation:</p>
<ul class="simple">
<li>Select positive integers <span class="math">\(a, b, A, B\)</span> at random.</li>
<li>Compute <span class="math">\(M = a b - 1\)</span>, <span class="math">\(e = A M + a\)</span>, <span class="math">\(d = B M + b\)</span>,
<span class="math">\(n = (e d - 1)//M\)</span>.</li>
<li>The <em>public key</em> is <span class="math">\((n, e)\)</span>. Bob sends these to Alice.</li>
<li>The <em>private key</em> is <span class="math">\((n, d)\)</span>, which Bob keeps secret.</li>
</ul>
<p>Encryption: If <span class="math">\(p\)</span> is the plaintext message then the
ciphertext is <span class="math">\(c = p e \pmod n\)</span>.</p>
<p>Decryption: If <span class="math">\(c\)</span> is the ciphertext message then the
plaintext is <span class="math">\(p = c d \pmod n\)</span>.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">kid_rsa_public_key</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kid_rsa_public_key</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="go">(369, 58)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.kid_rsa_private_key">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">kid_rsa_private_key</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>A</em>, <em>B</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#kid_rsa_private_key"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.kid_rsa_private_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute <span class="math">\(M = a b - 1\)</span>, <span class="math">\(e = A M + a\)</span>, <span class="math">\(d = B M + b\)</span>,
<span class="math">\(n = (e d - 1) / M\)</span>. The <em>private key</em> is <span class="math">\(d\)</span>, which Bob
keeps secret.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">kid_rsa_private_key</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kid_rsa_private_key</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="go">(369, 70)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.encipher_kid_rsa">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">encipher_kid_rsa</code><span class="sig-paren">(</span><em>msg</em>, <em>key</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#encipher_kid_rsa"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.encipher_kid_rsa" title="Permalink to this definition">¶</a></dt>
<dd><p>Here <code class="docutils literal"><span class="pre">msg</span></code> is the plaintext and <code class="docutils literal"><span class="pre">key</span></code> is the public key.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">encipher_kid_rsa</span><span class="p">,</span> <span class="n">kid_rsa_public_key</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span> <span class="o">=</span> <span class="mi">200</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="n">kid_rsa_public_key</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encipher_kid_rsa</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="go">161</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.decipher_kid_rsa">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">decipher_kid_rsa</code><span class="sig-paren">(</span><em>msg</em>, <em>key</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#decipher_kid_rsa"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.decipher_kid_rsa" title="Permalink to this definition">¶</a></dt>
<dd><p>Here <code class="docutils literal"><span class="pre">msg</span></code> is the plaintext and <code class="docutils literal"><span class="pre">key</span></code> is the private key.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">kid_rsa_public_key</span><span class="p">,</span> <span class="n">kid_rsa_private_key</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">decipher_kid_rsa</span><span class="p">,</span> <span class="n">encipher_kid_rsa</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">kid_rsa_private_key</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span> <span class="o">=</span> <span class="mi">200</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pub</span> <span class="o">=</span> <span class="n">kid_rsa_public_key</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pri</span> <span class="o">=</span> <span class="n">kid_rsa_private_key</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ct</span> <span class="o">=</span> <span class="n">encipher_kid_rsa</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">pub</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decipher_kid_rsa</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="n">pri</span><span class="p">)</span>
<span class="go">200</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.encode_morse">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">encode_morse</code><span class="sig-paren">(</span><em>msg</em>, <em>sep='|'</em>, <em>mapping=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#encode_morse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.encode_morse" title="Permalink to this definition">¶</a></dt>
<dd><p>Encodes a plaintext into popular Morse Code with letters
separated by <span class="math">\(sep\)</span> and words by a double <span class="math">\(sep\)</span>.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r84" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id9">[R84]</a></td><td><a class="reference external" href="http://en.wikipedia.org/wiki/Morse_code">http://en.wikipedia.org/wiki/Morse_code</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">encode_morse</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;ATTACK RIGHT FLANK&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encode_morse</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="go">&#39;.-|-|-|.-|-.-.|-.-||.-.|..|--.|....|-||..-.|.-..|.-|-.|-.-&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.decode_morse">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">decode_morse</code><span class="sig-paren">(</span><em>msg</em>, <em>sep='|'</em>, <em>mapping=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#decode_morse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.decode_morse" title="Permalink to this definition">¶</a></dt>
<dd><p>Decodes a Morse Code with letters separated by <span class="math">\(sep\)</span>
(default is &#8216;|&#8217;) and words by <span class="math">\(word_sep\)</span> (default is &#8216;||)
into plaintext.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r85" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id10">[R85]</a></td><td><a class="reference external" href="http://en.wikipedia.org/wiki/Morse_code">http://en.wikipedia.org/wiki/Morse_code</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">decode_morse</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="s1">&#39;--|---|...-|.||.|.-|...|-&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decode_morse</span><span class="p">(</span><span class="n">mc</span><span class="p">)</span>
<span class="go">&#39;MOVE EAST&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.lfsr_sequence">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">lfsr_sequence</code><span class="sig-paren">(</span><em>key</em>, <em>fill</em>, <em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#lfsr_sequence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.lfsr_sequence" title="Permalink to this definition">¶</a></dt>
<dd><p>This function creates an lfsr sequence.</p>
<p>INPUT:</p>
<blockquote>
<div><dl class="docutils">
<dt><code class="docutils literal"><span class="pre">key</span></code>: a list of finite field elements,</dt>
<dd><span class="math">\([c_0, c_1, \ldots, c_k].\)</span></dd>
<dt><code class="docutils literal"><span class="pre">fill</span></code>: the list of the initial terms of the lfsr</dt>
<dd>sequence, <span class="math">\([x_0, x_1, \ldots, x_k].\)</span></dd>
<dt><code class="docutils literal"><span class="pre">n</span></code>: number of terms of the sequence that the</dt>
<dd>function returns.</dd>
</dl>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div>The lfsr sequence defined by
<span class="math">\(x_{n+1} = c_k x_n + \ldots + c_0 x_{n-k}\)</span>, for
<span class="math">\(n \leq k\)</span>.</div></blockquote>
<p class="rubric">Notes</p>
<p>S. Golomb <a class="reference internal" href="#g85" id="id11">[G85]</a> gives a list of three statistical properties a
sequence of numbers <span class="math">\(a = \{a_n\}_{n=1}^\infty\)</span>,
<span class="math">\(a_n \in \{0,1\}\)</span>, should display to be considered
&#8220;random&#8221;. Define the autocorrelation of <span class="math">\(a\)</span> to be</p>
<div class="math">
\[C(k) = C(k,a) = \lim_{N\rightarrow \infty} {1\over N}\sum_{n=1}^N (-1)^{a_n + a_{n+k}}.\]</div>
<p>In the case where <span class="math">\(a\)</span> is periodic with period
<span class="math">\(P\)</span> then this reduces to</p>
<div class="math">
\[C(k) = {1\over P}\sum_{n=1}^P (-1)^{a_n + a_{n+k}}.\]</div>
<p>Assume <span class="math">\(a\)</span> is periodic with period <span class="math">\(P\)</span>.</p>
<ul>
<li><p class="first">balance:</p>
<div class="math">
\[\left|\sum_{n=1}^P(-1)^{a_n}\right| \leq 1.\]</div>
</li>
<li><p class="first">low autocorrelation:</p>
<blockquote>
<div><div class="math">
\[\begin{split}C(k) = \left\{ \begin{array}{cc} 1,&amp; k = 0,\\ \epsilon, &amp; k \ne 0. \end{array} \right.\end{split}\]</div>
</div></blockquote>
<p>(For sequences satisfying these first two properties, it is known
that <span class="math">\(\epsilon = -1/P\)</span> must hold.)</p>
</li>
<li><p class="first">proportional runs property: In each period, half the runs have
length <span class="math">\(1\)</span>, one-fourth have length <span class="math">\(2\)</span>, etc.
Moreover, there are as many runs of <span class="math">\(1\)</span>&#8216;s as there are of
<span class="math">\(0\)</span>&#8216;s.</p>
</li>
</ul>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="g85" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[G85]</td><td><em>(<a class="fn-backref" href="#id11">1</a>, <a class="fn-backref" href="#id12">2</a>)</em> Solomon Golomb, Shift register sequences, Aegean Park Press,
Laguna Hills, Ca, 1967</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">lfsr_sequence</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys.domains</span> <span class="k">import</span> <span class="n">FF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">FF</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fill</span> <span class="o">=</span> <span class="p">[</span><span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="p">[</span><span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lfsr_sequence</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">[1 mod 2, 1 mod 2, 0 mod 2, 1 mod 2, 0 mod 2,</span>
<span class="go">1 mod 2, 1 mod 2, 0 mod 2, 0 mod 2, 1 mod 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.lfsr_autocorrelation">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">lfsr_autocorrelation</code><span class="sig-paren">(</span><em>L</em>, <em>P</em>, <em>k</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#lfsr_autocorrelation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.lfsr_autocorrelation" title="Permalink to this definition">¶</a></dt>
<dd><p>This function computes the LFSR autocorrelation function.</p>
<p>INPUT:</p>
<blockquote>
<div><p><code class="docutils literal"><span class="pre">L</span></code>: is a periodic sequence of elements of <span class="math">\(GF(2)\)</span>.
<code class="docutils literal"><span class="pre">L</span></code> must have length larger than <code class="docutils literal"><span class="pre">P</span></code>.</p>
<p><code class="docutils literal"><span class="pre">P</span></code>: the period of <code class="docutils literal"><span class="pre">L</span></code></p>
<p><code class="docutils literal"><span class="pre">k</span></code>: an integer (<span class="math">\(0 &lt; k &lt; p\)</span>)</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div>the <code class="docutils literal"><span class="pre">k</span></code>-th value of the autocorrelation of the LFSR <code class="docutils literal"><span class="pre">L</span></code></div></blockquote>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">lfsr_sequence</span><span class="p">,</span> <span class="n">lfsr_autocorrelation</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys.domains</span> <span class="k">import</span> <span class="n">FF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">FF</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fill</span> <span class="o">=</span> <span class="p">[</span><span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="p">[</span><span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">lfsr_sequence</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lfsr_autocorrelation</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="go">-1/15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lfsr_autocorrelation</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.lfsr_connection_polynomial">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">lfsr_connection_polynomial</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#lfsr_connection_polynomial"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.lfsr_connection_polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>This function computes the LFSR connection polynomial.</p>
<p>INPUT:</p>
<blockquote>
<div><code class="docutils literal"><span class="pre">s</span></code>: a sequence of elements of even length, with entries in
a finite field</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><code class="docutils literal"><span class="pre">C(x)</span></code>: the connection polynomial of a minimal LFSR yielding
<code class="docutils literal"><span class="pre">s</span></code>.</div></blockquote>
<p>This implements the algorithm in section 3 of J. L. Massey&#8217;s
article <a class="reference internal" href="#m86" id="id13">[M86]</a>.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="m86" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[M86]</td><td><em>(<a class="fn-backref" href="#id13">1</a>, <a class="fn-backref" href="#id14">2</a>)</em> James L. Massey, &#8220;Shift-Register Synthesis and BCH Decoding.&#8221;
IEEE Trans. on Information Theory, vol. 15(1), pp. 122-127,
Jan 1969.</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">lfsr_sequence</span><span class="p">,</span> <span class="n">lfsr_connection_polynomial</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys.domains</span> <span class="k">import</span> <span class="n">FF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">FF</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fill</span> <span class="o">=</span> <span class="p">[</span><span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="p">[</span><span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">lfsr_sequence</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lfsr_connection_polynomial</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">x**4 + x + 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fill</span> <span class="o">=</span> <span class="p">[</span><span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="p">[</span><span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">lfsr_sequence</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lfsr_connection_polynomial</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">x**3 + 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fill</span> <span class="o">=</span> <span class="p">[</span><span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="p">[</span><span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">lfsr_sequence</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lfsr_connection_polynomial</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">x**3 + x**2 + 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fill</span> <span class="o">=</span> <span class="p">[</span><span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="p">[</span><span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">lfsr_sequence</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lfsr_connection_polynomial</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">x**3 + x + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.elgamal_public_key">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">elgamal_public_key</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#elgamal_public_key"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.elgamal_public_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Return three number tuple as public key.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>key</strong> : Tuple (p, r, e)  generated by <code class="docutils literal"><span class="pre">elgamal_private_key</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>(p, r, e = r**d mod p)</strong> : d is a random number in private key.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">elgamal_public_key</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">elgamal_public_key</span><span class="p">((</span><span class="mi">1031</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">636</span><span class="p">))</span>
<span class="go">(1031, 14, 212)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.elgamal_private_key">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">elgamal_private_key</code><span class="sig-paren">(</span><em>digit=10</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#elgamal_private_key"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.elgamal_private_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Return three number tuple as private key.</p>
<p>Elgamal encryption is based on the mathmatical problem
called the Discrete Logarithm Problem (DLP). For example,</p>
<p><span class="math">\(a^{b} \equiv c \pmod p\)</span></p>
<p>In general, if <code class="docutils literal"><span class="pre">a</span></code> and <code class="docutils literal"><span class="pre">b</span></code> are known, <code class="docutils literal"><span class="pre">ct</span></code> is easily
calculated. If <code class="docutils literal"><span class="pre">b</span></code> is unknown, it is hard to use
<code class="docutils literal"><span class="pre">a</span></code> and <code class="docutils literal"><span class="pre">ct</span></code> to get <code class="docutils literal"><span class="pre">b</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>digit</strong> : minimum number of binary digits for key</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>(p, r, d)</strong> : p = prime number, r = primitive root, d = random number</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>For testing purposes, the <code class="docutils literal"><span class="pre">seed</span></code> parameter may be set to control
the output of this routine. See sympy.utilities.randtest._randrange.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">elgamal_private_key</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory</span> <span class="k">import</span> <span class="n">is_primitive_root</span><span class="p">,</span> <span class="n">isprime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">elgamal_private_key</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">isprime</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_primitive_root</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.encipher_elgamal">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">encipher_elgamal</code><span class="sig-paren">(</span><em>i</em>, <em>key</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#encipher_elgamal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.encipher_elgamal" title="Permalink to this definition">¶</a></dt>
<dd><p>Encrypt message with public key</p>
<p><code class="docutils literal"><span class="pre">i</span></code> is a plaintext message expressed as an integer.
<code class="docutils literal"><span class="pre">key</span></code> is public key (p, r, e). In order to encrypt
a message, a random number <code class="docutils literal"><span class="pre">a</span></code> in <code class="docutils literal"><span class="pre">range(2,</span> <span class="pre">p)</span></code>
is generated and the encryped message is returned as
<span class="math">\(c_{1}\)</span> and <span class="math">\(c_{2}\)</span> where:</p>
<p><span class="math">\(c_{1} \equiv r^{a} \pmod p\)</span></p>
<p><span class="math">\(c_{2} \equiv m e^{a} \pmod p\)</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>msg</strong> : int of encoded message</p>
<p><strong>key</strong> : public key</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>(c1, c2)</strong> : Encipher into two number</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>For testing purposes, the <code class="docutils literal"><span class="pre">seed</span></code> parameter may be set to control
the output of this routine. See sympy.utilities.randtest._randrange.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">encipher_elgamal</span><span class="p">,</span> <span class="n">elgamal_private_key</span><span class="p">,</span> <span class="n">elgamal_public_key</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pri</span> <span class="o">=</span> <span class="n">elgamal_private_key</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span> <span class="n">pri</span>
<span class="go">(37, 2, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pub</span> <span class="o">=</span> <span class="n">elgamal_public_key</span><span class="p">(</span><span class="n">pri</span><span class="p">);</span> <span class="n">pub</span>
<span class="go">(37, 2, 8)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span> <span class="o">=</span> <span class="mi">36</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encipher_elgamal</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">pub</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="go">(8, 6)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.decipher_elgamal">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">decipher_elgamal</code><span class="sig-paren">(</span><em>msg</em>, <em>key</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#decipher_elgamal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.decipher_elgamal" title="Permalink to this definition">¶</a></dt>
<dd><p>Decrypt message with private key</p>
<p><span class="math">\(msg = (c_{1}, c_{2})\)</span></p>
<p><span class="math">\(key = (p, r, d)\)</span></p>
<p>According to extended Eucliden theorem,
<span class="math">\(u c_{1}^{d} + p n = 1\)</span></p>
<p><span class="math">\(u \equiv 1/{{c_{1}}^d} \pmod p\)</span></p>
<p><span class="math">\(u c_{2} \equiv \frac{1}{c_{1}^d} c_{2} \equiv \frac{1}{r^{ad}} c_{2} \pmod p\)</span></p>
<p><span class="math">\(\frac{1}{r^{ad}} m e^a \equiv \frac{1}{r^{ad}} m {r^{d a}} \equiv m \pmod p\)</span></p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">decipher_elgamal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">encipher_elgamal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">elgamal_private_key</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">elgamal_public_key</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pri</span> <span class="o">=</span> <span class="n">elgamal_private_key</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pub</span> <span class="o">=</span> <span class="n">elgamal_public_key</span><span class="p">(</span><span class="n">pri</span><span class="p">);</span> <span class="n">pub</span>
<span class="go">(37, 2, 8)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span> <span class="o">=</span> <span class="mi">17</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decipher_elgamal</span><span class="p">(</span><span class="n">encipher_elgamal</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">pub</span><span class="p">),</span> <span class="n">pri</span><span class="p">)</span> <span class="o">==</span> <span class="n">msg</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.dh_public_key">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">dh_public_key</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#dh_public_key"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.dh_public_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Return three number tuple as public key.</p>
<p>This is the tuple that Alice sends to Bob.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>key: Tuple (p, g, a) generated by ``dh_private_key``</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>(p, g, g^a mod p)</strong> : p, g and a as in Parameters</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">dh_private_key</span><span class="p">,</span> <span class="n">dh_public_key</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">dh_private_key</span><span class="p">();</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_p</span><span class="p">,</span> <span class="n">_g</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">dh_public_key</span><span class="p">((</span><span class="n">p</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">==</span> <span class="n">_p</span> <span class="ow">and</span> <span class="n">g</span> <span class="o">==</span> <span class="n">_g</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">==</span> <span class="nb">pow</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.dh_private_key">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">dh_private_key</code><span class="sig-paren">(</span><em>digit=10</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#dh_private_key"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.dh_private_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Return three integer tuple as private key.</p>
<p>Diffie-Hellman key exchange is based on the mathematical problem
called the Discrete Logarithm Problem (see ElGamal).</p>
<p>Diffie-Hellman key exchange is divided into the following steps:</p>
<ul class="simple">
<li>Alice and Bob agree on a base that consist of a prime <code class="docutils literal"><span class="pre">p</span></code>
and a primitive root of <code class="docutils literal"><span class="pre">p</span></code> called <code class="docutils literal"><span class="pre">g</span></code></li>
<li>Alice choses a number <code class="docutils literal"><span class="pre">a</span></code> and Bob choses a number <code class="docutils literal"><span class="pre">b</span></code> where
<code class="docutils literal"><span class="pre">a</span></code> and <code class="docutils literal"><span class="pre">b</span></code> are random numbers in range <span class="math">\([2, p)\)</span>. These are
their private keys.</li>
<li>Alice then publicly sends Bob <span class="math">\(g^{a} \pmod p\)</span> while Bob sends
Alice <span class="math">\(g^{b} \pmod p\)</span></li>
<li>They both raise the received value to their secretly chosen
number (<code class="docutils literal"><span class="pre">a</span></code> or <code class="docutils literal"><span class="pre">b</span></code>) and now have both as their shared key
<span class="math">\(g^{ab} \pmod p\)</span></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>digit: minimum number of binary digits required in key</strong></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>(p, g, a)</strong> : p = prime number, g = primitive root of p,</p>
<blockquote class="last">
<div><p>a = random number from 2 thru p - 1</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>For testing purposes, the <code class="docutils literal"><span class="pre">seed</span></code> parameter may be set to control
the output of this routine. See sympy.utilities.randtest._randrange.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">dh_private_key</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory</span> <span class="k">import</span> <span class="n">isprime</span><span class="p">,</span> <span class="n">is_primitive_root</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">dh_private_key</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">isprime</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_primitive_root</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">dh_private_key</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">isprime</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_primitive_root</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.crypto.crypto.dh_shared_key">
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">dh_shared_key</code><span class="sig-paren">(</span><em>key</em>, <em>b</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#dh_shared_key"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.crypto.crypto.dh_shared_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an integer that is the shared key.</p>
<p>This is what Bob and Alice can both calculate using the public
keys they received from each other and their private keys.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>key: Tuple (p, g, x) generated by ``dh_public_key``</strong></p>
<p><strong>b: Random number in the range of 2 to p - 1</strong></p>
<blockquote>
<div><p>(Chosen by second key exchange member (Bob))</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">shared key (int)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">dh_private_key</span><span class="p">,</span> <span class="n">dh_public_key</span><span class="p">,</span> <span class="n">dh_shared_key</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prk</span> <span class="o">=</span> <span class="n">dh_private_key</span><span class="p">();</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">dh_public_key</span><span class="p">(</span><span class="n">prk</span><span class="p">);</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sk</span> <span class="o">=</span> <span class="n">dh_shared_key</span><span class="p">((</span><span class="n">p</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sk</span> <span class="o">==</span> <span class="nb">pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">encipher_elgamal</code><span class="sig-paren">(</span><em>i</em>, <em>key</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#encipher_elgamal"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Encrypt message with public key</p>
<p><code class="docutils literal"><span class="pre">i</span></code> is a plaintext message expressed as an integer.
<code class="docutils literal"><span class="pre">key</span></code> is public key (p, r, e). In order to encrypt
a message, a random number <code class="docutils literal"><span class="pre">a</span></code> in <code class="docutils literal"><span class="pre">range(2,</span> <span class="pre">p)</span></code>
is generated and the encryped message is returned as
<span class="math">\(c_{1}\)</span> and <span class="math">\(c_{2}\)</span> where:</p>
<p><span class="math">\(c_{1} \equiv r^{a} \pmod p\)</span></p>
<p><span class="math">\(c_{2} \equiv m e^{a} \pmod p\)</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>msg</strong> : int of encoded message</p>
<p><strong>key</strong> : public key</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>(c1, c2)</strong> : Encipher into two number</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>For testing purposes, the <code class="docutils literal"><span class="pre">seed</span></code> parameter may be set to control
the output of this routine. See sympy.utilities.randtest._randrange.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">encipher_elgamal</span><span class="p">,</span> <span class="n">elgamal_private_key</span><span class="p">,</span> <span class="n">elgamal_public_key</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pri</span> <span class="o">=</span> <span class="n">elgamal_private_key</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span> <span class="n">pri</span>
<span class="go">(37, 2, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pub</span> <span class="o">=</span> <span class="n">elgamal_public_key</span><span class="p">(</span><span class="n">pri</span><span class="p">);</span> <span class="n">pub</span>
<span class="go">(37, 2, 8)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span> <span class="o">=</span> <span class="mi">36</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encipher_elgamal</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">pub</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="go">(8, 6)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">sympy.crypto.crypto.</code><code class="descname">decipher_elgamal</code><span class="sig-paren">(</span><em>msg</em>, <em>key</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/crypto/crypto.html#decipher_elgamal"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Decrypt message with private key</p>
<p><span class="math">\(msg = (c_{1}, c_{2})\)</span></p>
<p><span class="math">\(key = (p, r, d)\)</span></p>
<p>According to extended Eucliden theorem,
<span class="math">\(u c_{1}^{d} + p n = 1\)</span></p>
<p><span class="math">\(u \equiv 1/{{c_{1}}^d} \pmod p\)</span></p>
<p><span class="math">\(u c_{2} \equiv \frac{1}{c_{1}^d} c_{2} \equiv \frac{1}{r^{ad}} c_{2} \pmod p\)</span></p>
<p><span class="math">\(\frac{1}{r^{ad}} m e^a \equiv \frac{1}{r^{ad}} m {r^{d a}} \equiv m \pmod p\)</span></p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">decipher_elgamal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">encipher_elgamal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">elgamal_private_key</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.crypto.crypto</span> <span class="k">import</span> <span class="n">elgamal_public_key</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pri</span> <span class="o">=</span> <span class="n">elgamal_private_key</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pub</span> <span class="o">=</span> <span class="n">elgamal_public_key</span><span class="p">(</span><span class="n">pri</span><span class="p">);</span> <span class="n">pub</span>
<span class="go">(37, 2, 8)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span> <span class="o">=</span> <span class="mi">17</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decipher_elgamal</span><span class="p">(</span><span class="n">encipher_elgamal</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">pub</span><span class="p">),</span> <span class="n">pri</span><span class="p">)</span> <span class="o">==</span> <span class="n">msg</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/sympylogo.png" alt="Logo"/>
            </a></p><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">SymPy Modules Reference</a><ul>
      <li>Previous: <a href="ntheory.html" title="previous chapter">Number Theory</a></li>
      <li>Next: <a href="concrete.html" title="next chapter">Concrete Mathematics</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/modules/crypto.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015 SymPy Development Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.7</a>
      
      |
      <a href="../_sources/modules/crypto.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>